import React,{useEffect,useState,useContext} from 'react'; import API from '../api'; import Header from '../components/Header'; import { AuthContext } from '../context/AuthContext'; export default function Reservations(){ const [items,setItems]=useState([]); const {user}=useContext(AuthContext); useEffect(()=>{ API.get(user?.role==='admin'?'/reservations':'/reservations/me').then(r=>setItems(r.data)).catch(()=>{}); },[user]); const cancel=async id=>{ if(!confirm('Atšaukti?')) return; await API.delete('/reservations/'+id); setItems(items.filter(i=>i._id!==id)); }; return (<div><Header /><div className='content'><main className='main'><h2>{user?.role==='admin'?'Visos rezervacijos':'Mano rezervacijos'}</h2><ul>{items.map(i=> (<li key={i._id}>{i.user?.email||''} - {i.car?.make} {i.car?.model} ({new Date(i.startDate).toLocaleDateString()} to {new Date(i.endDate).toLocaleDateString()}) <button onClick={()=>cancel(i._id)} className='btn small'>Atšaukti</button></li>))}</ul></main></div><footer className='footer'>Kontaktai</footer></div>); }