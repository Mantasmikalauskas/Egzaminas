import React,{useEffect,useState,useContext} from 'react'; import { useParams,useNavigate } from 'react-router-dom'; import API from '../api'; import Header from '../components/Header'; import { AuthContext } from '../context/AuthContext'; export default function CarPage(){ const {id}=useParams(); const [car,setCar]=useState(null); const [start,setStart]=useState(''); const [end,setEnd]=useState(''); const {user}=useContext(AuthContext); const nav=useNavigate(); useEffect(()=>{ API.get('/cars/'+id).then(r=>setCar(r.data)).catch(()=>{}); },[id]); const book=async()=>{ if(!user){ alert('Prisijunkite'); nav('/login'); return } if(!start||!end){ alert('Pasirinkite datas'); return } try{ await API.post('/reservations',{carId:id,startDate:start,endDate:end}); alert('Rezervuota'); nav('/reservations'); }catch(e){ alert(e.response?.data?.message||e.message); } }; return (<div className='modal-page'><Header /><div className='modal'><button className='close' onClick={()=>nav(-1)}>X</button>{car? (<div className='modal-body'><img src={car.image||'/placeholder.png'} alt='' /><div className='info'><h2>{car.make} {car.model}</h2><p><strong>Automobilio aprašymas:</strong> {car.description}</p><p><strong>Nr:</strong> {car.licensePlate}</p><p><strong>Klasė:</strong> {car.carClass}</p><p><strong>Metai:</strong> {car.year}</p><p><strong>Kaina:</strong> {car.pricePerDay} €/day</p><div className='calendar'><label>nuo <input type='date' value={start} onChange={e=>setStart(e.target.value)} /></label><label>iki <input type='date' value={end} onChange={e=>setEnd(e.target.value)} /></label></div><div className='payments'><button className='btn' onClick={book}>Rezervuoti</button><button className='btn pay'>Apmokėti <span className='cards'>Visa • Mastercard • PayPal</span></button><button className='btn' onClick={()=>nav(-1)}>Uždaryti</button></div></div></div>) : <p>Loading...</p>}</div><footer className='footer'>Kontaktai</footer></div>); }