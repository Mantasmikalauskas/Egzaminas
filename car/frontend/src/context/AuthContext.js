import React,{createContext,useState} from 'react'; import * as authApi from '../api/auth';
export const AuthContext=createContext();
export function AuthProvider({children}){ const [user,setUser]=useState(()=>{try{return JSON.parse(localStorage.getItem('user'))}catch{return null}}); const login=async(email,password)=>{const res=await authApi.login({email,password}); localStorage.setItem('token',res.data.token); localStorage.setItem('user',JSON.stringify(res.data.user)); setUser(res.data.user);}; const register=async(p)=>{const res=await authApi.register(p); localStorage.setItem('token',res.data.token); localStorage.setItem('user',JSON.stringify(res.data.user)); setUser(res.data.user);}; const logout=()=>{localStorage.removeItem('token'); localStorage.removeItem('user'); setUser(null);}; return <AuthContext.Provider value={{user,login,register,logout}}>{children}</AuthContext.Provider>; }
